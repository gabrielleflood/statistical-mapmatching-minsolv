function [sols] = solver_3dreg_312_2(data)
[C0,C1] = setup_elimination_template(data);
C1 = C0 \ C1;
RR = [-C1(end-3:end,:);eye(8)];
AM_ind = [6,1,2,3,4,7,8,9];
AM = RR(AM_ind,:);
[V,D] = eig(AM);
V = V ./ (ones(size(V,1),1)*V(1,:));
sols(1,:) = diag(D).';
sols(2,:) = V(6,:);
sols(3,:) = V(7,:);

% Action =  x
% Quotient ring basis (V) = 1,x,x*y,x*z,x*z^2,y,z,z^2,
% Available monomials (RR*V) = x^2,x^2*y,x^2*z,x^2*z^2,1,x,x*y,x*z,x*z^2,y,z,z^2,
function [coeffs] = compute_coeffs(data)
tmp = reshape(data,3,3,(2+3));
xd_1 = tmp(:,2:3,1)-repmat(tmp(:,1,1),1,2);
xd_x = tmp(:,2:3,2)-repmat(tmp(:,1,2),1,2);
yd_1 = tmp(:,2:3,3)-repmat(tmp(:,1,3),1,2);
yd_y = tmp(:,2:3,4)-repmat(tmp(:,1,4),1,2);
yd_z = tmp(:,2:3,5)-repmat(tmp(:,1,5),1,2);
xs1_1 = xd_1'*xd_1; xs1_1 = xs1_1([1 2 4]);
xs1_x = 2*xd_1'*xd_x; xs1_x = xs1_x([1 2 3 4]); xs1_x = xs1_x*[1 0 0 0;0 1/2 1/2 0;0 0 0 1]';
xs1_x2 = xd_x'*xd_x; xs1_x2 = xs1_x2([1 2 4]);
xsc = [xs1_1;xs1_x;xs1_x2];

ys1_1 = yd_1'*yd_1; ys1_1 = ys1_1([1 2 4]);
ys1_z = 2*yd_1'*yd_z; ys1_z = ys1_z([1 2 3 4]); ys1_z = ys1_z*[1 0 0 0;0 1/2 1/2 0;0 0 0 1]';
ys1_z2 = yd_z'*yd_z; ys1_z2 = ys1_z2([1 2 4]);
ys1_y = 2*yd_1'*yd_y; ys1_y = ys1_y([1 2 3 4]); ys1_y = ys1_y*[1 0 0 0;0 1/2 1/2 0;0 0 0 1]';
ys1_yz = 2*yd_z'*yd_y; ys1_yz = ys1_yz([1 2 3 4]); ys1_yz = ys1_yz*[1 0 0 0;0 1/2 1/2 0;0 0 0 1]';
ys1_y2 = yd_y'*yd_y; ys1_y2 = ys1_y2([1 2 4]);
ysc = [ys1_1; ys1_z; ys1_z2; ys1_y; ys1_yz; ys1_y2];

xsc_exp = [xsc(1,:); zeros(5,3); xsc(2:3,:)];
ysc_exp = [ysc; zeros(2,3)];

e1c = xsc_exp(:,1)-ysc_exp(:,1);
e2c = xsc_exp(:,2)-ysc_exp(:,2);
e3c = xsc_exp(:,3)-ysc_exp(:,3);

ec = [e1c;e2c;e3c];
ii = [9 15 12 10 13 1 17 7 23 16 4 20 2 18 14 5 21 11 8 24 6 22 3 19];
coeffs = ec(ii)';


function [C0,C1] = setup_elimination_template(data)
[coeffs] = compute_coeffs(data);
coeffs0_ind = [19,10,20,21,15,22,16,5,21,15,22,17,23,18,16,5,17,24,23,18,24,19,10,20,21,15,22,21,15,22,8,2,16,5,9,17,11,3,16,12,5,21,22,17,15,13,4,11,3,12,...
23,14,18,16,17,24,5,13,4,14,23,24,18,11,3,22,15,21,12,6,1,13,7,4,11,12,17,5,16,14,3,8,2,20,10,19,9,19,10,20,19,20,10,19,10,20];
coeffs1_ind = [7,1,6,6,1,9,2,8,7,11,3,8,2,9,12,13,4,8,9,2,14,8,2,9,23,18,24,6,1,12,3,11,7,6,7,14,4,13,1,6,1,7,13,14,24,18,23,4];
C0_ind = [1,2,9,19,20,27,37,38,39,40,41,45,55,56,57,58,59,63,75,76,77,96,97,108,114,115,126,134,136,142,145,146,150,151,153,162,163,164,170,171,172,173,174,178,179,181,182,183,184,185,...
188,189,190,191,192,196,197,201,202,203,209,210,215,224,226,229,230,231,232,235,236,242,243,244,245,246,247,248,249,250,251,258,259,265,266,267,270,278,280,286,299,300,305,309,310,311];
C1_ind = [13,14,15,24,25,31,32,33,36,42,43,44,46,52,54,60,61,65,66,71,72,75,76,77,78,79,90,98,100,103,104,105,106,119,120,121,122,123,125,129,130,131,137,138,139,140,141,143];
C0 = zeros(18,18);
C1 = zeros(18,8);
C0(C0_ind) = coeffs(coeffs0_ind);
C1(C1_ind) = coeffs(coeffs1_ind);

